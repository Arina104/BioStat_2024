---
title: "Untitled"
author: "Arina"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(readxl)
```

```{r}
data_set <- read_csv("C:/Users/Huawei/Desktop/biostat_2024-2025/Доказательная медицина/carrental - carrental.csv")
```
```{r}
str(data_set)
```
```{r}
data_set %>%
  mutate(experience = as.factor(experience))
```

#Посчитали распространенность experients 
```{r}
data_set_1 <- data_set %>%
  filter(experience == '1')
nrow(data_set_1)/nrow(data_set) 
  
```
```{r}
length(which(data_set$experience == "1")) / length(which(data_set$experience  == "0"))
```
#Посчитали риск accident в общей группе
```{r}
length(which(data_set$accident == "1"))/nrow(data_set)
```
#Посчитали риск accident в группе без experients
```{r}
length(which(data_set$accident == "1")) / length(which(data_set$experience  == "0"))
```
#Посчитали риск accident в группе c experients
```{r}
length(which(data_set$accident == "1")) / length(which(data_set$experience  == "1"))
```
#Посчитали плотность событий (incidence rate) в общей группе
```{r}
length(which(data_set$accident == "1")) / (sum(data_set$stop) - sum(data_set$start))
```
#Посчитали плотность событий (incidence rate) в группе c experients
```{r}
data_set_2 <- data_set %>%
  filter(experience == '1')
length(which(data_set$accident == "1")) / (sum(data_set_2$stop) - sum(data_set_2$start))
```

#Посчитали плотность событий (incidence rate) в группе без experients
```{r}
data_set_3 <- data_set %>%
  filter(experience == '0')
length(which(data_set$accident == "1")) / (sum(data_set_3$stop) - sum(data_set_3$start))
```


---
title: "Untitled"
author: "Arina"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggpubr)
```

```{r}
hogwarts <- read_csv("C:/Users/Huawei/Desktop/biostat_2024-2025/Визуализация/data/hogwarts_2024.csv")
```
#Диаграммы рассеяния
##Задание 1

```{r}
hogwarts |>
  ggplot() +
  geom_point(aes(x = result,
                 y = `Herbology exam`)) +
  geom_smooth(aes(x = result,
                 y = `Herbology exam`), se=FALSE, method = 'lm') +
  theme_bw()

```
#с использованием координат х и у один раз
```{r}
hogwarts |>
  ggplot(aes(x = result,
                 y = `Herbology exam`)) +
  geom_point() +
  geom_smooth(method = 'lm', se = FALSE) +
  theme_bw()
```
Интерпретация: итоговая оценка прямо пропорционально зависит от оценки по экзамену по травологии. При получении высокой оценки по экзамену повышается итоговый балл. Прямопропорциональная зависимость

##Задание 2
```{r}
vector <- c(hogwarts$`Herbology exam`, hogwarts$`Divinations exam`, hogwarts$`Muggle studies exam`, hogwarts$`Potions exam`)

hogwarts |>
  ggplot(aes(x = result,
                 y = vector)) +
  geom_point() +
  theme_bw()
```
##Задание 3
```{r}

```


#geom_col
##Задание 1
```{r}
For_semest <- hogwarts |>
  group_by(house) |>
  summarise(points = sum(week_1, week_2, week_3, week_4, week_5, week_6, week_7, week_8, week_9, week_10, week_11, week_12, week_13, week_14, week_15, week_16, week_17))

ggplot(For_semest) +
  geom_col(aes(x = house,
               y = points)) +
  theme_bw()

```
Распределение получилось таким, потому что для факультета Гриффендора сумма всех балов за первый семестр вышла в ноль ( с учетом отрицательных значений). 

#Задание 2
```{r}
For_semest <- hogwarts |>
  group_by(house) |>
  summarise(points = sum(week_1, week_2, week_3, week_4, week_5, week_6, week_7, week_8, week_9, week_10, week_11, week_12, week_13, week_14, week_15, week_16, week_17))

ggplot(For_semest) +
  ylim(-4000, 8000) +
  geom_col(aes(fct_reorder(house, points, .desc = TRUE), points)) +
  geom_text(aes(y = points, x = house, label = points), size = 6, hjust = 0.5, vjust = -0.2) +
  theme_bw()
```

```{r}
For_semest <- hogwarts |>
  group_by(house) |>
  summarise(points = sum(week_1, week_2, week_3, week_4, week_5, week_6, week_7, week_8, week_9, week_10, week_11, week_12, week_13, week_14, week_15, week_16, week_17))

ggplot(For_semest) +
  geom_col(aes(fct_reorder(house, points, .desc = TRUE), points)) +
  geom_label(aes(y = points, x = house, label = points), size = 6, hjust = 0.5, vjust = -0.2) +
  labs(x = 'Факультеты', y = 'Сумма баллов за первый семестр') +
  ylim(-4000, 8000) +
  theme_bw()
```

##Задание 3
```{r}
For_semest <- hogwarts |>
  group_by(house, sex) |>
  summarise(points = sum(week_1, week_2, week_3, week_4, week_5, week_6, week_7, week_8, week_9, week_10, week_11, week_12, week_13, week_14, week_15, week_16, week_17))

ggplot(For_semest) +
  geom_col(aes(x = points, y = house, fill = house, color = sex), position = 'dodge2') +
  geom_label(aes(x = 6000, y = house, label = points), position = 'dodge2', size = 3, hjust = 0.5, vjust = -0.2) +
  labs(x = 'Факультеты', y = 'Сумма баллов за первый семестр') +
  scale_x_continuous(breaks = seq(-4000, 8000, 1000), limits = c(-4000,8000)) +
  theme_bw()
```

##Задание 4
coord_flip()
Функция может быть полезна


#Разное
##Задание 1
```{r}

```



#Воспроизведение графика

```{r}
plot_male <- hogwarts |>
  filter(sex == 'male') |>
  group_by(house) |>
  summarise(result)

p1 <- ggplot(plot_male) + 
  geom_violin(aes(x = house, y = result, fill = house)) +
  scale_fill_manual(values = c("Gryffindor" = "#C50000", 
                               "Hufflepuff" = "#ECB939", 
                               "Ravenclaw" = "#41A6D9", 
                               "Slytherin" = "#1F5D25"))+
  theme(legend.position = 'none') +
  theme_bw()

plot_female <- hogwarts |>
  filter(sex == 'female') |>
  group_by(house) |>
  summarise(result)

p2 <- ggplot(plot_female) + 
  geom_violin(aes(x = house, y = result, fill = house)) +
  scale_fill_manual(values = c("Gryffindor" = "#C50000", 
                               "Hufflepuff" = "#ECB939", 
                               "Ravenclaw" = "#41A6D9", 
                               "Slytherin" = "#1F5D25")) +
  theme_bw()

ggarrange(plotlist = list(p2, p1)) 
  
```

```{r}
plot_new <- hogwarts |>
  group_by(sex, house) |>
  summarise(result)

plot_new |>
  ggplot(aes(x = house, y = result, fill = house)) +
  geom_violin(aes(x = house, y = result, shape = sex))+
   scale_fill_manual(values = c("Gryffindor" = "#C50000", 
                               "Hufflepuff" = "#ECB939", 
                               "Ravenclaw" = "#41A6D9", 
                               "Slytherin" = "#1F5D25")) +
  theme_bw()

```

```{r}
ggplot(plot_male) + 
  geom_violin(aes(x = house, y = result, fill = house)) +
  scale_fill_manual(values = c("Gryffindor" = "#C50000", 
                               "Hufflepuff" = "#ECB939", 
                               "Ravenclaw" = "#41A6D9", 
                               "Slytherin" = "#1F5D25"))+
ggplot_add(plot_female) +
  geom_violin(aes(x = house, y = result, fill = house)) +
  theme_bw()
```

